%% SISTEMA 33 BARRAS
% 33 Bus Distribution Test System

% BARAN, M. E., WU, F. F., 1989, “Network Reconfiguration in Distribution 
% Systems for Loss Reduction and Load Balancing”, IEEE Transactions on Power 
% Delivery, vol. 4, no. 2, pp. 1401-1407.

% Wesley Peres Fev/12/2021
%% DCTE
DATA.Sb = 1;   % Power Basis MVA (1MVA)
Sb = 1e6;      % Potência Base
Vb = 12.66e3;  % Tensão Base 
%% No final, impedâncias e cargas estarão na base de 1MVA!
%% BUS DATA
% [       NUM    TIPO  V      TETA     PG        QG          PD             QD        GSH    BSH ]
DATA.DBAR = [   
           1      0   1.0000  0.0000   0          0          100.0          60.0      0.0    0.0;
           2      0   1.0000  0.0000   0          0           90.0          40.0      0.0    0.0;
           3      0   1.0000  0.0000   0          0          120.0          80.0      0.0    0.0;
           4      0   1.0000  0.0000   0          0           60.0          30.0      0.0    0.0;
           5      0   1.0000  0.0000   0          0           60.0          20.0      0.0    0.0;
           6      0   1.0000  0.0000   0          0          200.0         100.0      0.0    0.0;
           7      0   1.0000  0.0000   0          0          200.0         100.0      0.0    0.0;
           8      0   1.0000  0.0000   0          0           60.0          20.0      0.0    0.0;
           9      0   1.0000  0.0000   0          0           60.0          20.0      0.0    0.0;
           10      0  1.0000  0.0000   0          0           45.0          30.0      0.0    0.0;
           11      0  1.0000  0.0000   0          0           60.0          35.0      0.0    0.0;
           12      0  1.0000  0.0000   0          0           60.0          35.0      0.0    0.0;
           13      0  1.0000  0.0000   0          0          120.0          80.0      0.0    0.0;
           14      0  1.0000  0.0000   0          0           60.0          10.0      0.0    0.0;
           15      0  1.0000  0.0000   0          0           60.0          20.0      0.0    0.0;
           16      0  1.0000  0.0000   0          0           60.0          20.0      0.0    0.0;    
           17      0  1.0000  0.0000   0          0           90.0          40.0      0.0    0.0;
           18      0  1.0000  0.0000   0          0           90.0          40.0      0.0    0.0;
           19      0  1.0000  0.0000   0          0           90.0          40.0      0.0    0.0;
           20      0  1.0000  0.0000   0          0           90.0          40.0      0.0    0.0;
           21      0  1.0000  0.0000   0          0           90.0          40.0      0.0    0.0;
           22      0  1.0500  0.0000   0          0           90.0          50.0      0.0    0.0;
           23      0  1.0000  0.0000   0          0          420.0         200.0      0.0    0.0;
           24      0  1.0000  0.0000   0          0          420.0         200.0      0.0    0.0;
           25      0  1.0500  0.0000   0          0           60.0          25.0      0.0    0.0;
           26      0  1.0500  0.0000   0          0           60.0          25.0      0.0    0.0;
           27      0  1.0000  0.0000   0          0           60.0          20.0      0.0    0.0;
           28      0  1.0000  0.0000   0          0          120.0          70.0      0.0    0.0;
           29      0  1.0000  0.0000   0          0          200.0         600.0      0.0    0.0;
           30      0  1.0000  0.0000   0          0          150.0          70.0      0.0    0.0;
           31      0  1.0000  0.0000   0          0          210.0         100.0      0.0    0.0;
           32      0  1.0000  0.0000   0          0           60.0          40.0      0.0    0.0;
];

DATA.DBAR(:,7:8) = DATA.DBAR(:,7:8)*1e3/Sb;
%% DADOS DE LINHAS
% Os dados a seguir estão em ohms
%            [FR  TO   R          X         BSHtotal Tap   Tapmin  Tapmax]
DATA.DLIN = [ 
               1   2   0.4930     0.2511    0        0     0       0;
	           2   3   0.3660     0.1864    0        0     0       0;
               3   4   0.3811     0.1941    0        0     0       0;
               4   5   0.8190     0.7070    0        0     0       0;
               5   6   0.1872     0.6188    0        0     0       0;
               6   7   0.7114     0.2351    0        0     0       0;
               7   8   1.0300     0.7400    0        0     0       0;
               8   9   1.0440     0.7400    0        0     0       0;
               9   10  0.1966     0.0650    0        0     0       0;
	          10   11  0.3744     0.1238    0        0     0       0;
              11   12  1.4680     1.1550    0        0     0       0;
              12   13  0.5416     0.7129    0        0     0       0;
              13   14  0.5910     0.5260    0        0     0       0;
              14   15  0.7463     0.5450    0        0     0       0;
	          15   16  1.2890     1.7210    0        0     0       0;
	          16   17  0.7320     0.5740    0        0     0       0;
              1    18  0.1640     0.1565    0        0     0       0;
              18   19  1.5042     1.3554    0        0     0       0;
              19   20  0.4095     0.4784    0        0     0       0;
              20   21  0.7089     0.9373    0        0     0       0;
              2    22  0.4512     0.3083    0        0     0       0;
              22   23  0.8980     0.7091    0        0     0       0;
              23   24  0.8960     0.7011    0        0     0       0;
              5    25  0.2030     0.1034    0        0     0       0;
              25   26  0.2842     0.1447    0        0     0       0;
              26   27  1.0590     0.9337    0        0     0       0;
              27   28  0.8042     0.7006    0        0     0       0;
              28   29  0.5075     0.2585    0        0     0       0;
              29   30  0.9744     0.9630    0        0     0       0;
              30   31  0.3105     0.3619    0        0     0       0;
              31   32  0.3410     0.5302    0        0     0       0;
             ];
         
Zb = Vb^2/Sb;
DATA.DLIN(:,3:4) = DATA.DLIN(:,3:4)/Zb; 
DATA.DLIN(:,9) = 1300;     % SMAX MVA

%%
%% DADOS DAS UNIDADES GERADORAS E COEFICIENTES DE CUSTO         
gen1 = 9;  gen2 = 19;  gen3 = 30;
% ------------------------------------------------------------------------ 
% Colunas de Interesse: NUM, Pgmin Qgmim    Qgmax Vmin  Vmax  Sgmax
%             [NUM Pgmin   Pgmax   Qgmim    Qgmax    a    b   c   Vmin  Vmax  Sgmax]
DATA.DLIMG =  [  gen1  0     999999  -1.20    1.20    7.705 0   0   0.90 1.10   3.0
                            gen2  0     999999  -0.60    0.60   11.731 0   0   0.90 1.10   1.0
                            gen3  0     999999  -0.90    0.90   10.363 0   0   0.90 1.10   1.5
              ];
          
%             [NUM Pgmin   Pgmax   Qgmim    Qgmax    a    b   c   Vmin  Vmax  Sgmax]          
DATA.DLIMG =  [  gen1  0     999999  -1.20    1.20    7.705 0   0   0.90 1.10   2.0
                            gen2  0     999999  -1.20    1.20   11.731 0   0   0.90 1.10   2.0
                            gen3  0     999999  -1.20    1.20   10.363 0   0   0.90 1.10   2.0
              ];
          
% ------------------------------------------------------------------------ 
%% LIMITES DE TENSÃO NAS BARRAS DO SISTEMA
%           [Vmin Vmax]
DATA.DTEN = [0.90 1.10];

%% DADOS DINÂMICOS -- GERADORES
% DADOS DE GERAÇÃO E AVR na mesma ordem! Sempre!
% DGEN      [ NUM Bar    BASE   Estatismo(Sp)   Fvz      Sq          Vvz]
DATA.DGEN = [  1  gen1     1      0.013287        1.0125   0.0049373   1.0221;  
                          2  gen2     1      0.014114        1.0125   0.0049872   1.0105;
                          3  gen3     1      0.013012        1.0125   0.0049598   1.0199;
            ];
% A ordem de NUM em DATA.DLIMG  e em DATA.DGEN deve ser igual
%%
DATA.freq = 60;   % Frequência Nominal
%% LIMITES DE FREQUÊNCIA
% -------------------------------------------------------------------
% Para a Frequência a Vazio no Caso de Otimizá-la
DATA.freq_min_vz = 59.7/DATA.freq;    % --> Programa Trabalha em Pu!
DATA.freq_max_vz = 60.3/DATA.freq;    % --> Programa Trabalha em Pu!
% -------------------------------------------------------------------
%%